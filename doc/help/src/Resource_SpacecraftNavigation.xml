<?xml version="1.0" encoding="UTF-8"?>
<refentry version="5.0" xml:id="SpacecraftNavigation"
          xmlns="http://docbook.org/ns/docbook"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:xi="http://www.w3.org/2001/XInclude"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns:m="http://www.w3.org/1998/Math/MathML"
          xmlns:html="http://www.w3.org/1999/xhtml"
          xmlns:db="http://docbook.org/ns/docbook">
  <indexterm>
    <primary>SpacecraftNavigation</primary>
  </indexterm>

  <indexterm>
    <primary>Orbit Determination</primary>

    <secondary>Spacecraft navigation</secondary>
  </indexterm>

  <refmeta>
    <refentrytitle>Spacecraft Navigation</refentrytitle>

    <refmiscinfo class="source">GMAT</refmiscinfo>

    <refmiscinfo class="manual">Resources</refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>Spacecraft Navigation</refname>

    <refpurpose>There are a number of <guilabel>Spacecraft</guilabel> fields
    that are used exclusively to support GMAT's navigation (orbit
    determination) capability.</refpurpose>
  </refnamediv>

  <refsection>
    <title>Description</title>

    <para>When using GMAT's navigation (orbit determination) capabilities,
    certain Spacecraft parameters can be estimated or "solved-for." As
    discussed in the <xref linkend="SpacecraftBallisticMass"
    xrefstyle="select:title"/> section, the <guilabel>Spacecraft</guilabel>
    ballistic and mass properties include the coefficient of reflectivity,
    <guilabel>Cr</guilabel>, and the coefficient of drag,
    <guilabel>Cd</guilabel>. As part of GMAT's navigation capability, GMAT can
    ingest measurements and estimate ("solve-for") either the
    <guilabel>CartesianState</guilabel>, or
    <guilabel>KeplerianState</guilabel>, as well as any of a set of associated
    force modeling parameters. See the <guilabel>SolveFors</guilabel>
    parameter below for a full list of estimated parameters.</para>

    <para><phrase role="ref_seealso">See Also</phrase>: <xref
    linkend="BatchEstimator"/></para>
  </refsection>

  <refsection>
    <title>Fields</title>

    <informaltable colsep="0" frame="topbot">
      <tgroup cols="2">
        <colspec colnum="1" colwidth="1.0*"/>

        <colspec colnum="2" colwidth="3*"/>

        <thead>
          <row>
            <entry>Field</entry>

            <entry>Description</entry>
          </row>
        </thead>

        <tbody>
          <row>
            <entry><guilabel>AddHardware</guilabel><indexterm>
                <primary>AddHardware</primary>
              </indexterm></entry>

            <entry><para>List of <guilabel>Antenna</guilabel>,
            <guilabel>Transmitter</guilabel>, <guilabel>Receiver</guilabel>,
            and <guilabel>Transponder</guilabel> objects attached to a
            <guilabel>Spacecraft</guilabel></para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para><guilabel>Antenna</guilabel>,
                    <guilabel>Transmitter</guilabel>,
                    <guilabel>Receiver</guilabel>, or
                    <guilabel>Transponder</guilabel> object</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Any user defined <guilabel>Antenna</guilabel>,
                    <guilabel>Transmitter</guilabel>,
                    <guilabel>Receiver</guilabel>, or
                    <guilabel>Transponder</guilabel> object</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>None</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>AtmosDensityScaleFactorSigma</guilabel><indexterm>
                <primary>AtmosDensityScaleFactorSigma</primary>
              </indexterm></entry>

            <entry><para>Standard deviation of the atmospheric density scale
            factor, <guilabel>AtmosDensityScaleFactor</guilabel>. For the
            batch estimator, this field is only used if the
            <guilabel>UseInitialCovariance</guilabel> field of the
            <guilabel>BatchEstimator</guilabel> resource is set to True and
            <guilabel>AtmosDensityScaleFactor</guilabel> is estimated.
            </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Real</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Real &gt; 0</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>1.0E+70</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>dimensionless</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>CdSigma</guilabel><indexterm>
                <primary>CdSigma</primary>
              </indexterm></entry>

            <entry><para>Standard deviation of the coefficient of drag,
            <guilabel>Cd</guilabel>. For the batch estimator, this field is
            only used if the <guilabel>UseInitialCovariance</guilabel> field
            of the <guilabel>BatchEstimator</guilabel> resource is set to True
            and <guilabel>Cd</guilabel> is estimated. </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Real</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Real &gt; 0</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>1.0E+70</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>dimensionless</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>CrSigma</guilabel><indexterm>
                <primary>CrSigma</primary>
              </indexterm></entry>

            <entry><para>Standard deviation of the coefficient of
            reflectivity, <guilabel>Cr</guilabel>. For the batch estimator,
            this field is only used if the
            <guilabel>UseInitialCovariance</guilabel> field of the
            <guilabel>BatchEstimator</guilabel> resource is set to True and
            <guilabel>Cr</guilabel> is estimated. </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Real</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Real &gt; 0</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>1.0E+70</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>dimensionless</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>OrbitErrorCovariance</guilabel><indexterm>
                <primary>OrbitErrorCovariance</primary>
              </indexterm></entry>

            <entry><para>State 6x6 error covariance matrix. If
            <guilabel>CartesianState</guilabel> is estimated, this must be a
            Cartesian covariance. If <guilabel>KeplerianState</guilabel> is
            estimated, this must be a Keplerian covariance. Regardless of
            choice of spacecraft coordinate system, the covariance must be
            specified in the EarthMJ2000Eq coordinate system.</para><para>For
            the batch estimator, this field is only used if the
            <guilabel>UseInitialCovariance</guilabel> of the
            <guilabel>BatchEstimator</guilabel> resource is set to
            True.</para><para>For the extended Kalman filter, this field sets
            the spacecraft initial covariance in cold-start mode. This field
            is ignored by the extended Kalman filter when running in
            warm-start mode.</para><para>For the Propagate command, the
            covariance may be specified in any coordinate system defined with
            MJ2000Eq axes. This will contain the propagated Cartesian
            covariance. The Covariance may be output in user defined
            coordinate systems, including non-MJ2000Eq systems, using the
            syntax <emphasis
            role="bold">Spacecraft.CoordinateSystem.OrbitErrorCovariance</emphasis></para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Real Matrix</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>6x6 positive definite symmetric
                    <guilabel>Array</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set, get</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>6x6 diagonal matrix with 1e70 in all diagonal
                    entries.</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>For Cartesian elements: covariance matrix where
                    position is specified in km and velocity in km/s. (Thus,
                    first three diagonal elements have units km^2 and last
                    three diagonal elements have units (km/s)^2)</para>

                    <para>For Keplerian elements: covariance matrix in km and
                    degrees (For example, the SMA element of the matrix has
                    units km^2 and the INC element has units deg^2). The order
                    of Keplerian elements is (SMA, ECC, INC, RAAN, AOP, MA).
                    See the Remarks section for additional notes.</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>ProcessNoiseModel</guilabel><indexterm>
                <primary>ProcessNoiseModel</primary>
              </indexterm></entry>

            <entry><para>An instance of
            <guilabel>ProcessNoiseModel</guilabel>. This is used by an
            <guilabel>ExtendedKalmanFilter</guilabel> and the
            <literal>Covariance</literal> option of the <emphasis
            role="bold">Propagate</emphasis> command to account for general
            force modeling errors.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Resource</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Any user defined
                    <guilabel>ProcessNoiseModel</guilabel> resource</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>None</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>SolveFors</guilabel><indexterm>
                <primary>SolveFors</primary>
              </indexterm></entry>

            <entry><para>List of fields to be solved for. This list must at
            least include either <guilabel>CartesianState</guilabel> or
            <guilabel>KeplerianState</guilabel> (but not both). For example,
            <guilabel>Cr</guilabel> cannot be the only parameter solved for.
            </para><para>When using the batch estimator, it is not possible to
            simultaneously estimate both <guilabel>Cd</guilabel> and
            <guilabel>AtmosDensityScaleFactor</guilabel> since they are
            linearly-dependent parameters. They may be simultaneously
            estimated in the extended Kalman filter, by configuring them as
            separate <guilabel>EstimatedParameter</guilabel>
            resources.</para><para>Estimation of KeplerianElements is not
            currently supported for the ExtendedKalmanFilter
            estimator.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>StringArray</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>CartesianState, KeplerianState (BatchEstimator
                    only), Cr, Cd, SPADDragScaleFactor, SPADSRPScaleFactor,
                    AtmosDensityScaleFactor</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>None</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>SPADDragScaleFactorSigma</guilabel><indexterm>
                <primary>SPADDragScaleFactorSigma</primary>
              </indexterm></entry>

            <entry><para>Standard deviation of the SPAD drag scale factor. For
            the batch estimator, this field is only used if the
            <guilabel>UseInitialCovariance</guilabel> field of the
            <guilabel>BatchEstimator</guilabel> resource is set to True and
            <guilabel>SPADDragScaleFactor</guilabel> is
            estimated.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Real</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Real &gt; 0</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>1.0E+70</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>dimensionless</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>Script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>SPADSRPScaleFactorSigma</guilabel><indexterm>
                <primary>SPADSRPScaleFactorSigma</primary>
              </indexterm></entry>

            <entry><para>Standard deviation of the SPAD SRP scale factor. For
            the batch estimator, this field is only used if the
            <guilabel>UseInitialCovariance</guilabel> field of the
            <guilabel>BatchEstimator</guilabel> resource is set to True and
            <guilabel>SPADSRPScaleFactor</guilabel> is
            estimated.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Real</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Real &gt; 0</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>1.0E+70</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>dimensionless</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>Script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>
        </tbody>
      </tgroup>
    </informaltable>
  </refsection>

  <refsection>
    <title>Remarks</title>

    <para>When estimating <guilabel>CartesianState</guilabel>, the input
    <guilabel>OrbitErrorCovariance</guilabel> matrix must represent a
    Cartesian covariance, and when estimating
    <guilabel>KeplerianState</guilabel> the
    <guilabel>OrbitErrorCovariance</guilabel> must represent a Keplerian
    covariance. Note that Keplerian covariance input employs Mean Anomaly (MA)
    instead of True Anomaly. The current release of GMAT only supports input
    of Keplerian orbit elements using TA and does not permit explicitly
    setting an initial MA. After estimation completes,
    <guilabel>OrbitErrorCovariance</guilabel> is updated to the value of the
    estimated covariance matrix.</para>

    <para>For more details, see <xref
    linkend="BatchEstimator_UseInitialCovariance"/> in the Batch Estimator
    resource.</para>
  </refsection>

  <refsection>
    <title>Examples</title>

    <informalexample>
      <para>Solve for Cr and the spacecraft Cartesian state.</para>

      <programlisting><code>Create Spacecraft Sat
Create BatchEstimator bat
Sat.SolveFors = {CartesianState, Cr}
%User must create a TrackingFileSet
%and set up bat appropriately

BeginMissionSequence
RunEstimator bat</code></programlisting>
    </informalexample>

    <informalexample>
      <para>Solve for Cd and the spacecraft Cartesian state assuming that the
      <emphasis>a priori</emphasis> information is included in the estimation
      state vector.</para>

      <programlisting><code>Create Spacecraft Sat
Sat.SolveFors = {CartesianState, Cd}

Create BatchEstimator bat
bat.UseInitialCovariance= True  
%User must create a TrackingFileSet
%and set up bat appropriately

Create Array Initial_6x6_covariance[6,6]

BeginMissionSequence
Initial_6x6_covariance = ...
       diag([1e-6 1e70 1e70 1e70 1e70 1e70]) %X pos known very well
Sat.OrbitErrorCovariance = Initial_6x6_covariance
Sat.CrSigma = 1e-6   %Cr known very well

RunEstimator bat</code></programlisting>
    </informalexample>
  </refsection>
</refentry>
