<?xml version="1.0" encoding="UTF-8"?>
<refentry version="5.0" xml:id="ProcessNoiseModel"
          xmlns="http://docbook.org/ns/docbook"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:xi="http://www.w3.org/2001/XInclude"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns:m="http://www.w3.org/1998/Math/MathML"
          xmlns:html="http://www.w3.org/1999/xhtml"
          xmlns:db="http://docbook.org/ns/docbook">
  <indexterm>
    <primary>ProcessNoiseModel</primary>
  </indexterm>

  <indexterm>
    <primary>State noise compensation</primary>
  </indexterm>

  <refmeta>
    <refentrytitle>ProcessNoiseModel</refentrytitle>

    <refmiscinfo class="source">GMAT</refmiscinfo>

    <refmiscinfo class="manual">Resources</refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>ProcessNoiseModel</refname>

    <refpurpose>Used to specify process noise for estimation when using the
    ExtendedKalmanFilter estimator.</refpurpose>
  </refnamediv>

  <refsection>
    <title>Description</title>

    <para>A <guilabel>ProcessNoiseModel</guilabel> is assigned on the
    <guilabel>ProcessNoiseModel</guilabel> field of an instance of
    <guilabel>Spacecraft</guilabel> to allow an
    <guilabel>ExtendedKalmanFilter</guilabel> to account for general errors in
    force modeling. This is additionally used to include noise calculations
    when propagating covariance using the <emphasis
    role="bold">Propagate</emphasis> command.</para>

    <para>See also <xref linkend="ExtendedKalmanFilter"/>, <xref
    linkend="SpacecraftNavigation"/></para>
  </refsection>

  <refsection>
    <title>Fields</title>

    <informaltable colsep="0" frame="topbot">
      <tgroup cols="2">
        <colspec colnum="1" colwidth="1.0*"/>

        <colspec colnum="2" colwidth="3*"/>

        <thead>
          <row>
            <entry>Field</entry>

            <entry>Description</entry>
          </row>
        </thead>

        <tbody>
          <row>
            <entry><guilabel>AccelNoiseSigma</guilabel></entry>

            <entry><para>Three-axis process noise sigma. The root variance
            along each axis of an assumed Gaussian noise
            process.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Array</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Real &gt; 0</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para><guilabel>[1.0e-8 1.0e-8 1.0e-8]</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>Depends on process noise model type; see remarks
                    below</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>CoordinateSystem</guilabel></entry>

            <entry><para>Reference coordinate system for the process noise
            acceleration sigma vector. </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>String</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Name of any built-in or user defined
                    <guilabel>CoordinateSystem</guilabel> resource</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para><guilabel>EarthMJ2000Eq</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>Type</guilabel></entry>

            <entry><para>Process noise modeling type. See remarks below for
            additional details.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Enumeration</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para><guilabel>StateNoiseCompensation</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para><guilabel>StateNoiseCompensation</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>UpdateTimeStep</guilabel></entry>

            <entry><para>The time step at which to update the ProcessNoise and
            propagate the Covariance. If set to 0, then updates will occur at
            each integration step. When using multiple models for Covariance
            propagation in a <emphasis role="bold">Propagate</emphasis>
            command, this parameter must match on all models. See the remarks
            below for additional details.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Real</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Real &gt; 0</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para><guilabel>0</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>Seconds</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>
        </tbody>
      </tgroup>
    </informaltable>
  </refsection>

  <refsection>
    <title>Remarks</title>

    <refsection>
      <title>State Noise Compensation</title>

      <para>The <guilabel>StateNoiseCompensation</guilabel> process noise type
      implements the process noise algorithm described in Tapley, Schutz, and
      Born, <emphasis>Statistical Orbit Determination</emphasis>, Section 4.9
      and Appendix F. The process noise is assumed to be an additive Gaussian
      noise process applied to the total deterministic acceleration. For this
      scheme, the user provides the diagonal elements of the following matrix
      in a chosen reference frame.</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Resource_ProcessNoiseModel_SNC_PNSD.png"
                       scalefit="1" width="100%"/>
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>where <emphasis>q<subscript>1</subscript></emphasis>,
      <emphasis>q<subscript>2</subscript></emphasis>, and
      <emphasis>q<subscript>3</subscript></emphasis> are the squares of the
      elements of the specified <guilabel>AccelNoiseSigma</guilabel> in the
      selected <guilabel>CoordinateSystem</guilabel>. The process noise
      <emphasis role="bold">S</emphasis> is then given by the matrix</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Resource_ProcessNoiseModel_SNC_PN.png"
                       scalefit="1" width="100%"/>
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>Where <emphasis role="bold"><inlineequation>
          <m:math display="inline">
            <m:mi>Δ</m:mi>

            <m:mi>t</m:mi>
          </m:math>
        </inlineequation></emphasis> is obtained from a time grid formed by
      the union of the input measurement times and the chosen
      <guilabel>ProcessNoiseModel</guilabel>
      <guilabel>UpdateTimeStep</guilabel>. When used in the context of
      covariance propagation using the <emphasis
      role="bold">Propagate</emphasis> command, <emphasis
      role="bold"><inlineequation>
          <m:math display="inline">
            <m:mi>Δ</m:mi>

            <m:mi>t</m:mi>
          </m:math>
        </inlineequation></emphasis> is the union of the each integration step
      and the UpdateTimeStep between the start and end of the of the
      propagation. <emphasis role="bold"><inlineequation>
          <m:math display="inline">
            <m:mi>Q̃</m:mi>
          </m:math>
        </inlineequation> </emphasis>is the <emphasis role="bold">Q</emphasis>
      matrix transformed into the coordinate system of integration. Process
      noise is added according to this formulation at each time update and
      measurement update during filtering and prediction.</para>

      <para>Determination of appropriate values of
      <emphasis>q<subscript>1</subscript></emphasis>,
      <emphasis>q<subscript>2</subscript></emphasis>, and
      <emphasis>q<subscript>3</subscript></emphasis> often involves
      experimentation via trial and error or a parametric analysis. References
      1 and 2 indicate that an appropriate starting point for such tuning, in
      the case of near-circular orbits dominated by along-track error, can be
      derived from the following equation</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Resource_ProcessNoiseModel_SNC_QTuning.png"
                       scalefit="1" width="100%"/>
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>Where <inlineequation>
          <m:math display="inline">
            <m:msub>
              <m:mi>σ</m:mi>

              <m:mn>AT</m:mn>
            </m:msub>
          </m:math>
        </inlineequation> is the along-track error per orbit period (perhaps
      determined empirically), and <emphasis>T</emphasis> is the orbit period
      in seconds. Note that the square root of
      <emphasis>q<subscript>AT</subscript></emphasis> is specified when
      inputting the components of the <guilabel>AccelNoiseSigma</guilabel>.
      For State Noise Compensation, the units of
      <guilabel>AccelNoiseSigma</guilabel> are
      km/second<superscript>3/2</superscript>.</para>
    </refsection>
  </refsection>

  <refsection>
    <title>Examples</title>

    <informalexample>
      <para>This example shows how to create and assign a
      <guilabel>ProcessNoiseModel</guilabel>.</para>

      <programlisting>%   Create a ProcessNoiseModel
 
Create ProcessNoiseModel SNC;

SNC.Type             = StateNoiseCompensation;
SNC.CoordinateSystem = EarthMJ2000Eq;
SNC.AccelNoiseSigma  = [1e-8 1e-8 1e-8];
SNC.UpdateTimeStep   = 120.
 
%   Assign it to a Spacecraft
 
Create Spacecraft EstSat;

EstSat.ProcessNoiseModel = SNC;
</programlisting>
    </informalexample>
  </refsection>

  <refsection>
    <title>References</title>

    <orderedlist>
      <listitem>
        <para>Carpenter, Russell and Chris D'Souza. <emphasis>Navigation
        Filter Best Practices</emphasis>. Technical Report TP-2018-219822,
        NASA, April 2018.</para>
      </listitem>

      <listitem>
        <para>Geller, David. <emphasis>Orbital Rendezvous: When is Autonomy
        Required?</emphasis>. Journal of Guidance, Control, and Dynamics, Vol.
        30, No.4. July-August 2007.</para>
      </listitem>
    </orderedlist>
  </refsection>
</refentry>
