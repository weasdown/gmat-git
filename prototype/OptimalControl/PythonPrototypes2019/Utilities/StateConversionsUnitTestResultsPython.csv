Testing State Transformations

Input State Rep, Output State Rep, mu (km^3/s^2), Input State (6 elements), Output State (6 elements)
1, 1, 398600.4415, 2.5775753505053918e-12, 42095.0, 0.0, -3.0771851701009485, 1.884232484473915e-16, 0.0, 2.5775753505053918e-12, 42095.0, 0.0, -3.0771851701009485, 1.884232484473915e-16, 0.0
1, 2, 398600.4415, 2.5775753505053918e-12, 42095.0, 0.0, -3.0771851701009485, 1.884232484473915e-16, 0.0, 42095.0, 0.0, 0.0, 0.0, 0.0, 1.5707963267948966
1, 4, 398600.4415, 2.5775753505053918e-12, 42095.0, 0.0, -3.0771851701009485, 1.884232484473915e-16, 0.0, 42095.0, 1.5707963267948966, 0.0, 3.0771851701009485, 1.5707963267948966, 1.5707963267948966
2, 1, 398600.4415, 42095.0, 0.0, 0.0, 0.0, 0.0, 1.5707963267948966, 2.5775753505053918e-12, 42095.0, 0.0, -3.0771851701009485, 1.884232484473915e-16, 0.0
2, 2, 398600.4415, 42095.0, 0.0, 0.0, 0.0, 0.0, 1.5707963267948966, 42095.0, 0.0, 0.0, 0.0, 0.0, 1.5707963267948966
2, 4, 398600.4415, 42095.0, 0.0, 0.0, 0.0, 0.0, 1.5707963267948966, 42095.0, 1.5707963267948966, 0.0, 3.0771851701009485, 1.5707963267948966, 1.5707963267948966
4, 1, 398600.4415, 42095.0, 1.5707963267948966, 0.0, 3.0771851701009485, 1.5707963267948966, 1.5707963267948966, 2.5775753505053918e-12, 42095.0, 0.0, -3.0771851701009485, 3.76846496894783e-16, 1.884232484473915e-16
4, 2, 398600.4415, 42095.0, 1.5707963267948966, 0.0, 3.0771851701009485, 1.5707963267948966, 1.5707963267948966, 42095.0, 6.123233995736766e-17, 0.0, 0.0, 0.0, 1.5707963267948966
4, 4, 398600.4415, 42095.0, 1.5707963267948966, 0.0, 3.0771851701009485, 1.5707963267948966, 1.5707963267948966, 42095.0, 1.5707963267948966, 0.0, 3.0771851701009485, 1.5707963267948966, 1.5707963267948966
1, 1, 398600.4415, -18489.828299081273, -11988.080375568767, 0.0, 5.090406172983034, -2.3258374268627353, 0.0, -18489.828299081273, -11988.080375568767, 0.0, 5.090406172983034, -2.3258374268627353, 0.0
1, 2, 398600.4415, -18489.828299081273, -11988.080375568767, 0.0, 5.090406172983034, -2.3258374268627353, 0.0, 82095.0000000003, 0.8181000000000007, 0.0, 4.999999999999999, 0.0, 5.0
1, 4, 398600.4415, -18489.828299081273, -11988.080375568767, 0.0, 5.090406172983034, -2.3258374268627353, 0.0, 22036.05730661916, -2.5663706143591734, 0.0, 5.596584203077735, 1.5707963267948966, 2.1377884699765657
2, 1, 398600.4415, 82095.0, 0.8181, 0.0, 2.0, 3.0, 5.0, -18489.828299081273, -11988.080375568767, 0.0, 5.090406172983034, -2.3258374268627353, 0.0
2, 2, 398600.4415, 82095.0, 0.8181, 0.0, 2.0, 3.0, 5.0, 82095.0, 0.8181, 0.0, 2.0, 3.0, 5.0
2, 4, 398600.4415, 82095.0, 0.8181, 0.0, 2.0, 3.0, 5.0, 22036.05730661916, -2.5663706143591734, 0.0, 5.596584203077735, 1.5707963267948966, 2.1377884699765657
4, 1, 398600.4415, 22036.05730661916, -2.5663706143591734, 0.0, 5.596584203077735, 1.5707963267948966, 2.1377884699765657, -18489.828299081277, -11988.080375568763, 0.0, 5.090406172983033, -2.325837426862736, 2.8906761361755525e-16
4, 2, 398600.4415, 22036.05730661916, -2.5663706143591734, 0.0, 5.596584203077735, 1.5707963267948966, 2.1377884699765657, 82095.00000000012, 0.8181000000000004, 0.0, 5.0, 0.0, 4.999999999999999
4, 4, 398600.4415, 22036.05730661916, -2.5663706143591734, 0.0, 5.596584203077735, 1.5707963267948966, 2.1377884699765657, 22036.05730661916, -2.5663706143591734, 0.0, 5.596584203077735, 1.5707963267948966, 2.1377884699765657
1, 1, 398600.4415, -2777.104067443927, -1174.1407674454595, -6867.247371167648, 6.148201253806822, 2.5994177975469883, -2.930763380045807, -2777.104067443927, -1174.1407674454595, -6867.247371167648, 6.148201253806822, 2.5994177975469883, -2.930763380045807
1, 2, 398600.4415, -2777.104067443927, -1174.1407674454595, -6867.247371167648, 6.148201253806822, 2.5994177975469883, -2.930763380045807, 7499.999999999997, 2.673890926034386e-16, 1.5707963267948966, 0.0, 0.39999999999999997, 4.298672286269282
1, 4, 398600.4415, -2777.104067443927, -1174.1407674454595, -6867.247371167648, 6.148201253806822, 2.5994177975469883, -2.930763380045807, 7499.999999999999, -2.741592653589793, -1.1570796326794897, 7.2901800755079655, 3.141592653589793, 1.5707963267948966
2, 1, 398600.4415, 7500.0, 0.0, 1.5707963267948966, 1.0, 0.4, 3.2986722862692828, -2777.104067443927, -1174.1407674454595, -6867.247371167648, 6.148201253806822, 2.5994177975469883, -2.930763380045807
2, 2, 398600.4415, 7500.0, 0.0, 1.5707963267948966, 1.0, 0.4, 3.2986722862692828, 7500.0, 0.0, 1.5707963267948966, 1.0, 0.4, 3.2986722862692828
2, 4, 398600.4415, 7500.0, 0.0, 1.5707963267948966, 1.0, 0.4, 3.2986722862692828, 7499.999999999999, -2.741592653589793, -1.1570796326794897, 7.2901800755079655, 3.141592653589793, 1.5707963267948966
4, 1, 398600.4415, 7499.999999999999, -2.741592653589793, -1.1570796326794897, 7.2901800755079655, 3.141592653589793, 1.5707963267948966, -2777.1040674439255, -1174.1407674454586, -6867.247371167648, 6.148201253806822, 2.5994177975469874, -2.930763380045806
4, 2, 398600.4415, 7499.999999999999, -2.741592653589793, -1.1570796326794897, 7.2901800755079655, 3.141592653589793, 1.5707963267948966, 7499.999999999997, 2.755431850188959e-16, 1.5707963267948966, 0.0, 0.39999999999999997, 4.298672286269283
4, 4, 398600.4415, 7499.999999999999, -2.741592653589793, -1.1570796326794897, 7.2901800755079655, 3.141592653589793, 1.5707963267948966, 7499.999999999999, -2.741592653589793, -1.1570796326794897, 7.2901800755079655, 3.141592653589793, 1.5707963267948966
1, 1, 398600.4415, -1880.8375761824575, 5587.694658666197, -3033.870662762062, -7.4441137208316475, -1.8054469696886333, 0.9802777225873882, -1880.8375761824575, 5587.694658666197, -3033.870662762062, -7.4441137208316475, -1.8054469696886333, 0.9802777225873882
1, 2, 398600.4415, -1880.8375761824575, 5587.694658666197, -3033.870662762062, -7.4441137208316475, -1.8054469696886333, 0.9802777225873882, 6577.999999999998, 0.0200000000000001, 0.4974188368183839, 2.9999999999999942, 3.141592653589793, 2.0000000000000058
1, 4, 398600.4415, -1880.8375761824575, 5587.694658666197, -3033.870662762062, -7.4441137208316475, -1.8054469696886333, 0.9802777225873882, 6630.554485473666, 1.89548713771205, -0.47524815786864555, 7.722396795194674, 1.4179810832005533, 1.5524598027839145
2, 1, 398600.4415, 6578.0, 0.02, 0.49741883681838395, 3.0, 3.141592653589793, 2.0, -1880.8375761824575, 5587.694658666197, -3033.870662762062, -7.4441137208316475, -1.8054469696886333, 0.9802777225873882
2, 2, 398600.4415, 6578.0, 0.02, 0.49741883681838395, 3.0, 3.141592653589793, 2.0, 6578.0, 0.02, 0.49741883681838395, 3.0, 3.141592653589793, 2.0
2, 4, 398600.4415, 6578.0, 0.02, 0.49741883681838395, 3.0, 3.141592653589793, 2.0, 6630.554485473666, 1.89548713771205, -0.47524815786864555, 7.722396795194674, 1.4179810832005533, 1.5524598027839145
4, 1, 398600.4415, 6630.554485473666, 1.89548713771205, -0.47524815786864555, 7.722396795194674, 1.4179810832005533, 1.5524598027839145, -1880.837576182457, 5587.694658666196, -3033.870662762062, -7.444113720831648, -1.8054469696886333, 0.9802777225873877
4, 2, 398600.4415, 6630.554485473666, 1.89548713771205, -0.47524815786864555, 7.722396795194674, 1.4179810832005533, 1.5524598027839145, 6578.0, 0.020000000000000035, 0.4974188368183839, 3.000000000000006, 3.141592653589793, 1.9999999999999942
4, 4, 398600.4415, 6630.554485473666, 1.89548713771205, -0.47524815786864555, 7.722396795194674, 1.4179810832005533, 1.5524598027839145, 6630.554485473666, 1.89548713771205, -0.47524815786864555, 7.722396795194674, 1.4179810832005533, 1.5524598027839145
1, 1, 398600.4415, 2053.1764359867198, 324.11026405633766, -6296.322088670272, 7.067726877725189, -2.3545307361991, 2.0344124598044626, 2053.1764359867198, 324.11026405633766, -6296.322088670272, 7.067726877725189, -2.3545307361991, 2.0344124598044626
1, 2, 398600.4415, 2053.1764359867198, 324.11026405633766, -6296.322088670272, 7.067726877725189, -2.3545307361991, 2.0344124598044626, 6578.0, 0.020000000000000046, 1.710422666954443, 2.999999999999992, 6.0, 2.000000000000007
1, 4, 398600.4415, 2053.1764359867198, 324.11026405633766, -6296.322088670272, 7.067726877725189, -2.3545307361991, 2.0344124598044626, 6630.554485473667, 0.15656600417962224, -1.2519321239604975, 7.7223967951946735, -0.4600021344010227, 1.5524598027839145
2, 1, 398600.4415, 6578.0, 0.02, 1.710422666954443, 3.0, 6.0, 2.0, 2053.1764359867198, 324.11026405633766, -6296.322088670272, 7.067726877725189, -2.3545307361991, 2.0344124598044626
2, 2, 398600.4415, 6578.0, 0.02, 1.710422666954443, 3.0, 6.0, 2.0, 6578.0, 0.02, 1.710422666954443, 3.0, 6.0, 2.0
2, 4, 398600.4415, 6578.0, 0.02, 1.710422666954443, 3.0, 6.0, 2.0, 6630.554485473667, 0.15656600417962224, -1.2519321239604975, 7.7223967951946735, -0.4600021344010227, 1.5524598027839145
4, 1, 398600.4415, 6630.554485473667, 0.15656600417962224, -1.2519321239604975, 7.7223967951946735, -0.4600021344010227, 1.5524598027839145, 2053.176435986719, 324.11026405633754, -6296.322088670272, 7.06772687772519, -2.354530736199099, 2.0344124598044617
4, 2, 398600.4415, 6630.554485473667, 0.15656600417962224, -1.2519321239604975, 7.7223967951946735, -0.4600021344010227, 1.5524598027839145, 6578.000000000002, 0.01999999999999998, 1.7104226669544427, 3.0000000000000053, 6.0, 1.9999999999999956
4, 4, 398600.4415, 6630.554485473667, 0.15656600417962224, -1.2519321239604975, 7.7223967951946735, -0.4600021344010227, 1.5524598027839145, 6630.554485473667, 0.15656600417962224, -1.2519321239604975, 7.7223967951946735, -0.4600021344010227, 1.5524598027839145
1, 1, 398600.4415, 3554.1085680006227, 5535.196138066343, -7.724831829741005e-13, 6.550298607569095, -4.205898368085045, 2.7041716126569817e-16, 3554.1085680006227, 5535.196138066343, -7.724831829741005e-13, 6.550298607569095, -4.205898368085045, 2.7041716126569817e-16
1, 2, 398600.4415, 3554.1085680006227, 5535.196138066343, -7.724831829741005e-13, 6.550298607569095, -4.205898368085045, 2.7041716126569817e-16, 6578.0, 7.104677067353844e-17, 3.141592653589793, 0.0, 6.0, 5.0
1, 4, 398600.4415, 3554.1085680006227, 5535.196138066343, -7.724831829741005e-13, 6.550298607569095, -4.205898368085045, 2.7041716126569817e-16, 6578.0, 1.0, -1.17434354359091e-16, 7.784342806620355, -1.5707963267948966, 1.5707963267948968
2, 1, 398600.4415, 6578.0, 0.0, 3.141592653589793, 3.0, 6.0, 2.0, 3554.1085680006227, 5535.196138066343, -7.724831829741005e-13, 6.550298607569095, -4.205898368085045, 2.7041716126569817e-16
2, 2, 398600.4415, 6578.0, 0.0, 3.141592653589793, 3.0, 6.0, 2.0, 6578.0, 0.0, 3.141592653589793, 3.0, 6.0, 2.0
2, 4, 398600.4415, 6578.0, 0.0, 3.141592653589793, 3.0, 6.0, 2.0, 6578.0, 1.0, -1.17434354359091e-16, 7.784342806620355, -1.5707963267948966, 1.5707963267948968
4, 1, 398600.4415, 6578.0, 1.0, -1.17434354359091e-16, 7.784342806620355, -1.5707963267948966, 1.5707963267948968, 3554.1085680006236, 5535.196138066343, -7.724831829741005e-13, 6.550298607569094, -4.2058983680850455, 4.766535250796673e-16
4, 2, 398600.4415, 6578.0, 1.0, -1.17434354359091e-16, 7.784342806620355, -1.5707963267948966, 1.5707963267948968, 6578.0, 1.4209354134707686e-16, 3.141592653589793, 0.0, 6.193023498843654, 5.193023498843653
4, 4, 398600.4415, 6578.0, 1.0, -1.17434354359091e-16, 7.784342806620355, -1.5707963267948966, 1.5707963267948968, 6578.0, 1.0, -1.17434354359091e-16, 7.784342806620355, -1.5707963267948966, 1.5707963267948968
1, 1, 398600.4415, 5920.2, 0.0, 0.0, 0.0, 5.269602992298378e-16, 8.605914776353934, 5920.2, 0.0, 0.0, 0.0, 5.269602992298378e-16, 8.605914776353934
1, 2, 398600.4415, 5920.2, 0.0, 0.0, 0.0, 5.269602992298378e-16, 8.605914776353934, 6578.000000000003, 0.10000000000000037, 1.5707963267948966, 0.0, 0.0, 0.0
1, 4, 398600.4415, 5920.2, 0.0, 0.0, 0.0, 5.269602992298378e-16, 8.605914776353934, 5920.2, 0.0, 0.0, 8.605914776353934, 6.123233995736766e-17, 1.5707963267948966
2, 1, 398600.4415, 6578.0, 0.1, 1.5707963267948966, 0.0, 0.0, 0.0, 5920.2, 0.0, 0.0, 0.0, 5.269602992298378e-16, 8.605914776353934
2, 2, 398600.4415, 6578.0, 0.1, 1.5707963267948966, 0.0, 0.0, 0.0, 6578.0, 0.1, 1.5707963267948966, 0.0, 0.0, 0.0
2, 4, 398600.4415, 6578.0, 0.1, 1.5707963267948966, 0.0, 0.0, 0.0, 5920.2, 0.0, 0.0, 8.605914776353934, 6.123233995736766e-17, 1.5707963267948966
4, 1, 398600.4415, 5920.2, 0.0, 0.0, 8.605914776353934, 6.123233995736766e-17, 1.5707963267948966, 5920.2, 0.0, 0.0, 5.269602992298378e-16, 5.269602992298378e-16, 8.605914776353934
4, 2, 398600.4415, 5920.2, 0.0, 0.0, 8.605914776353934, 6.123233995736766e-17, 1.5707963267948966, 6578.000000000003, 0.10000000000000037, 1.5707963267948966, 6.283185307179586, 0.0, 0.0
4, 4, 398600.4415, 5920.2, 0.0, 0.0, 8.605914776353934, 6.123233995736766e-17, 1.5707963267948966, 5920.2, 0.0, 0.0, 8.605914776353934, 6.123233995736766e-17, 1.5707963267948966

Testing State Transformation Jacobians

Cartesian input state (km, km/s): 2053.1764359867198, 324.11026405633766, -6296.322088670272, 7.067726877725189, -2.3545307361991, 2.0344124598044626
Mu (km^3/s^2): 398600.4415

d x_cart / d x_kep
0.3121277646680927,779.4339485685724,1759.2899732267063,6031.814022047172,-324.11026405633993,6069.466361083983,
0.049271855283724506,123.03986080165114,6045.541384721569,-2027.9156155580254,2053.1764359867143,-2021.9718937552298,
-0.9571787912238179,-2390.2315948182586,884.8903618968245,1862.5333941827737,0.0,1747.067791805718,
-0.0005372246030499537,-0.6138311797106782,-0.5684463709983641,-2.262059555371531,2.354530736199099,-2.410933616538281,
0.00017897010764663266,1.2899140607338797,-1.9533823946955202,-0.42072317632011114,7.06772687772519,-0.3805850862997069,
-0.00015463761476166427,-7.592264631271167,-0.28591802522986337,7.371668117820581,0.0,7.393429185170093,

d x_cart / d x_sph
0.3096538065534116,-324.11026405633754,6219.308999724813,0.0,0.0,0.0,
0.04888132127809278,2053.176435986719,981.7674929529555,0.0,0.0,0.0,
-0.9495920895400773,0.0,2078.6007169626864,0.0,0.0,0.0,
0.0,2.354530736199099,-2.0095286648663655,0.9152245170985183,2.1363989926137825,-2.2620595553715366,
0.0,7.06772687772519,-0.31722011551608814,-0.30489636814107063,7.34142109639577,-0.42072317632010847,
0.0,0.0,6.614143154336211,0.2634431399679426,1.0745692333269543,7.3716681178205805,

d x_kep / d x_cart
0.6095291229472524,0.09621902995078971,-1.8691972171676658,1534.474646025833,-511.19232258008867,441.69142259410023,
0.00010725016492867505,-4.519822178059996e-05,9.556390728818014e-05,-0.05913260055914367,0.03774768512239184,-0.1403267643961698,
4.023345416851955e-05,0.00013825635110053565,2.0236684322279582e-05,-0.01016542670593596,-0.034931994599715945,-0.00511302187447422,
0.004865155644670468,-0.0005807752497828989,-0.00566427243262816,11.501118963956825,-3.439642983348465,0.7590544993994289,
1.1212637371517038e-05,3.853058011639495e-05,5.639749496952903e-06,0.03470209593649365,0.11924865162271699,0.017454513297487623,
-0.004726397000027278,0.000540011204002532,0.005707422057123746,-11.496289365655631,3.4562391879801364,-0.7566253006580802,

d x_sph / d x_cart
0.3096538065534118,0.048881321278092804,-0.9495920895400773,0.0,0.0,0.0,
-7.501543623772368e-05,0.0004752084185516149,0.0,0.0,0.0,0.0,
0.00014146286143341667,2.233104012384367e-05,4.727933685431997e-05,0.0,0.0,0.0,
0.0,0.0,0.0,0.9152245170985182,-0.30489636814107074,0.2634431399679427,
7.046878705743778e-05,-0.0004538839197628938,-3.849205920931404e-07,0.03583638294732733,0.12314646219999777,0.018025038713301002,
-0.00013719814713029273,4.6126466096963554e-05,-4.236472306940337e-05,-0.037931481808444065,-0.00705492190560643,0.12361226053708907,
